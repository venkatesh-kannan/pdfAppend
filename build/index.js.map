{"version":3,"sources":["../src/index.js"],"names":["PORT","process","env","app","router","express","Router","moment","require","path","HummusRecipe","fs","request","use","bodyParser","json","req","res","next","header","route","put","pdfURL","outputFilename","src","join","__dirname","get","uri","encoding","pdfBuffer","writeFileSync","downloadPDF","url","body","unlinkSync","error","output","then","joiningDate","currentDate","diff","toFixed","console","log","format","pdfDoc","editPage","text","color","fontSize","font","endPage","endPDF","file","createReadStream","stat","statSync","setHeader","size","pipe","listen"],"mappings":"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","file":"index.js","sourcesContent":["import express from 'express';\nimport cors from 'cors';\nimport bodyParser from 'body-parser';\nconst PORT = process.env.PORT || 5000\nconst app = express();\nconst router = express.Router();\nconst moment = require('moment');\nconst path = require('path');\nconst HummusRecipe = require('hummus-recipe');\nvar fs = require('fs');\nconst request = require(\"request-promise-native\");\n\napp.use(cors());\napp.use(bodyParser.json());\napp.use(function (req, res, next) {\n    res.header(\"Access-Control-Allow-Origin\", \"*\");\n    res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n    next();\n});\n\n\nrouter.route('/getResume').put((req, res) => {\n    let url = req.body.url\n    try {\n        fs.unlinkSync(path.join(__dirname, '/outputFile.pdf'));\n    } catch (error) {\n\n    }\n    let src;\n    const output = path.join(__dirname, '/outputFile.pdf');\n\n    async function downloadPDF(pdfURL, outputFilename) {\n        src = path.join(__dirname, outputFilename);\n        let pdfBuffer = await request.get({ uri: pdfURL, encoding: null });\n        fs.writeFileSync(src, pdfBuffer);\n    }\n\n    downloadPDF(url, '/resume.pdf').then(dta => {\n\n        let joiningDate = moment(\"2015-05-18\");\n        let currentDate = moment();\n        let diff = currentDate.diff(joiningDate, 'years', true).toFixed(1);\n        console.log(diff,' years experience on ',moment().format('YYYY-MM-DD'));\n        const pdfDoc = new HummusRecipe(src, output);\n        pdfDoc\n            .editPage(1)\n            .text(diff, 378, 68, {\n                color: '#000000',\n                fontSize: 9,\n                font: 'Arial',\n            })\n            .endPage()\n            .endPDF();\n        var file = fs.createReadStream(output);\n        var stat = fs.statSync(output);\n        res.setHeader('Content-Length', stat.size);\n        res.setHeader('Content-Type', 'application/pdf');\n        res.setHeader('Content-Disposition', 'attachment; filename=venkatesh_kannan.pdf');\n        file.pipe(res);\n    })\n});\n\n\napp.use('/', router);\n\napp.listen(PORT, () => console.log(`Listening on ${PORT}`))"]}